(this["webpackJsonpreact-tsapp"]=this["webpackJsonpreact-tsapp"]||[]).push([[0],{1001:function(e,t,n){"use strict";n.r(t);n(481),n(483),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(507),n(508),n(357),n(510),n(511),n(512),n(513),n(514),n(515),n(516),n(517),n(518),n(519),n(520),n(521),n(522),n(523),n(525),n(527),n(528),n(529),n(530),n(531),n(532),n(533),n(534),n(535),n(536),n(537),n(538),n(540),n(541),n(542),n(543),n(544),n(545),n(546),n(547),n(548),n(549),n(550),n(551),n(553),n(554),n(555),n(556),n(557),n(558),n(560),n(562),n(564),n(566),n(567),n(568),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(576),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(587),n(588),n(594),n(595),n(596),n(598),n(599),n(600),n(601),n(602),n(603),n(604),n(605),n(606),n(607),n(608),n(375),n(609),n(610),n(611),n(612),n(613),n(614),n(615),n(616),n(617),n(618),n(619),n(620),n(621),n(622),n(624),n(625),n(626),n(627),n(628),n(629),n(630),n(631),n(632),n(633),n(634),n(635),n(636),n(637),n(638),n(639),n(640),n(641),n(642),n(643),n(645),n(646),n(647),n(648),n(649),n(650),n(651),n(652),n(653),n(654),n(655),n(656),n(658),n(659),n(660),n(661),n(662),n(663),n(664),n(665),n(666),n(667),n(668),n(669),n(670),n(671),n(672),n(673),n(674),n(675),n(676),n(677),n(678),n(679),n(680);var a=n(0),c=n.n(a),i=n(56),r=n.n(i),s=(n(685),n(206)),o=n(54),l=n(162),d=n(163),u=n(172),j=n(171),h=(n(382),n(264)),b=(n(303),n(102)),f=(n(305),n(58)),O=n(103),p=(n(465),n(260)),g=(n(307),n(147)),x=(n(306),n(134)),m=n(72),v=(n(466),n(151)),w=(n(694),n(476)),k=function(){var e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("Trident")>-1,a=e.indexOf("Edge")>-1,c=e.indexOf("Firefox")>-1,i=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome"),r=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;return n?"IE":t?"Opera":a?"Edge":c?"FF":i?"Safari":r?"Chrome":void 0},S=(n(697),n(176)),C=n.n(S);function y(e,t){return new Promise((function(n,a){C.a.get(e,{params:t}).then((function(e){n(e.data)})).catch((function(e){a(e)}))}))}C.a.defaults.baseURL="http://localhost/",C.a.defaults.headers.common["Content-Type"]="application/json;charset=UTF-8",C.a.defaults.timeout=2e4;var D=function(e){return y("/api/downLoadAWorl",e)},N=function(e){return function(e,t){return new Promise((function(n,a){C.a.post(e,t).then((function(e){n(e.data)})).catch((function(e){a(e)}))}))}("/api/downLoadAll",e)},A=n(8),I=w.a.Search,L=v.a.Meta,P=function(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),c=n[0],i=n[1],r=Object(a.useState)(0),s=Object(m.a)(r,2),o=s[0],l=s[1],d=Object(a.useState)(1),u=Object(m.a)(d,2),j=u[0],h=u[1],b=Object(a.useState)(!1),f=Object(m.a)(b,2),O=f[0],v=f[1],w=Object(a.useState)(8),k=Object(m.a)(w,1)[0],S=e.changeList;Object(a.useEffect)((function(){C()}),[]);var C=function(){var e;v(!0),(e={key:c,from:j,size:k},y("/api/pingccApi/search",e)).then((function(e){var t=e.data||{count:0,data:[]},n=t.count,a=t.data;l(n),S(a),v(!1)})).catch((function(){v(!1)}))},D=function(e){i(e.target.value)};return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(I,{placeholder:"\u8bf7\u8f93\u5165\u67e5\u8be2\u6761\u4ef6",allowClear:!0,style:{width:300},value:c,enterButton:"Search",onInput:D,onSearch:function(e){e===c&&C()},onChange:D}),Object(A.jsx)(g.a,{delay:500,spinning:O,children:0===o?Object(A.jsx)(x.a,{}):Object(A.jsx)("div",{className:"content",children:e.children})}),Object(A.jsx)(p.a,{className:"textAlignR",total:o,hideOnSinglePage:!0,showSizeChanger:!1,defaultCurrent:j,onChange:function(e){h(e),C()}})]})},R=function(e){var t=e.dataList,n={xs:8,sm:6,md:6,lg:6,xl:3};return Object(A.jsx)(h.b,{children:Object(A.jsx)(b.a,{gutter:[20,20],children:t.map((function(e,t){return Object(a.createElement)(f.a,Object(O.a)(Object(O.a)({},n),{},{key:t}),Object(A.jsx)(F,Object(O.a)({},e)))}))})})},F=function(e){var t=Object(o.f)();return Object(A.jsx)(v.a,{hoverable:!0,onClick:function(){t.push({pathname:"/list/".concat(e.cartoonId,"/").concat(e.title)})},style:{width:"100%"},cover:Object(A.jsx)("img",{alt:"example",src:e.cover}),children:Object(A.jsx)(L,{title:e.title,description:e.descs})})},T=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={dataList:[],pageIndex:1,count:0,pageSize:10},e.changeList=function(t){e.setState({dataList:t})},e}return Object(d.a)(n,[{key:"render",value:function(){return"IE"===k()?Object(A.jsx)("div",{className:"padding20",children:"\u4e0d\u517c\u5bb9IE,\u8bf7\u4f7f\u7528Chrome\u6d4f\u89c8\u5668\u6253\u5f00\u672c\u7f51\u5740\uff01"}):Object(A.jsx)("div",{className:"padding20",children:Object(A.jsx)(P,{changeList:this.changeList,children:Object(A.jsx)(R,{dataList:this.state.dataList})})})}}]),n}(a.Component),E=(n(728),n(274)),B=(n(730),n(472)),z=(n(1003),n(475)),W=(n(735),n(343)),H=(n(737),n(479)),M=(n(1002),n(474)),U=(n(745),n(477)),V=(n(747),n(478)),J=(n(749),n(342)),_=(n(751),n(473)),Y=(n(156),n(50)),q=(n(753),n(116)),G=(n(755),n(1008));function K(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,n=!0;return function(){if(!n)return q.b.warning("\u4e0d\u8981\u70b9\u51fb\u7684\u592a\u9891\u7e41\uff01"),!1;n=!1,e.apply(void 0,arguments),setTimeout((function(){n=!0}),t)}}var Q={height:40,width:40,lineHeight:"40px",borderRadius:4,backgroundColor:"#1088e9",color:"#fff",textAlign:"center",fontSize:14},X=function(e){var t=e.childRef,n=e.aDown,c=e.isNowDown,i=Object(a.useState)(!1),r=Object(m.a)(i,2),s=r[0],o=r[1],l=Object(a.useState)(""),d=Object(m.a)(l,2),u=d[0],j=d[1],h=Object(a.useState)([]),b=Object(m.a)(h,2),f=b[0],O=b[1],p=Object(a.useState)(!1),x=Object(m.a)(p,2),v=x[0],w=x[1],k=Object(a.useState)({}),S=Object(m.a)(k,2),C=S[0],D=S[1];Object(a.useImperativeHandle)(t,(function(){return{getValue:function(e){return N(e)}}}));var N=function(e){var t,n=e.title,a=e.chapterId;o(!0),j(n),O([]),w(!0),D(e),(t=a,y("/api/pingccApi/detail?chapterId=".concat(t))).then((function(e){O(e.data.data.content),w(!1)}))};return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(J.a,{title:u,placement:"right",width:window.innerWidth/4*3,closable:!1,onClose:function(){o(!1)},visible:s,footer:Object(A.jsx)("div",{style:{textAlign:"left"},children:Object(A.jsx)(Y.a,{onClick:function(){return n(C)},disabled:c,type:"primary",icon:Object(A.jsx)(G.a,{}),children:"Download"})}),children:Object(A.jsx)(g.a,{spinning:v,children:f.map((function(e,t){return Object(A.jsx)(_.a,{preview:!1,width:window.innerWidth/4*3-70,src:e},t)}))})})})},Z=function(e){var t=e.childRef,n=e.setDownStatus,c=Object(a.useState)(!1),i=Object(m.a)(c,2),r=i[0],s=i[1],l=Object(a.useState)({}),d=Object(m.a)(l,2),u=d[0],j=d[1],h=Object(a.useState)(0),O=Object(m.a)(h,2),p=O[0],g=O[1],x=Object(o.f)();Object(a.useImperativeHandle)(t,(function(){return{getValue:function(e){return w(e)}}})),Object(a.useEffect)((function(){var e=new WebSocket("ws://localhost:8888/");e.onopen=function(){console.log("\u5df2\u8fde\u63a5...")},e.onmessage=function(e){var t=e.data,a=JSON.parse(t);a.message?(q.b.success(a.message),n(),j({})):(g(Number(a.progress)),n(!0),j({allPage:a.allPage,downPage:a.downPage,progress:a.progress}))},e.onclose=function(){console.log("\u8fde\u63a5\u5df2\u5173\u95ed..."),V.a.error({title:"\u8fde\u63a5\u5df2\u5173\u95ed",content:"\u670d\u52a1\u8fc7\u8f7d\uff0c\u5d29\u6389\u4e86\u3002\u8bf7\u91cd\u542f\u670d\u52a1\uff01\uff01"}),x.push({pathname:"/error"})}}),[]);var w=function(e){s(!0)};return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(J.a,{title:"\u4e0b\u8f7d\u8fdb\u5ea6",placement:"right",width:window.innerWidth/4*3,closable:!1,onClose:function(){s(!1)},visible:r,children:[Object(A.jsx)("div",{className:"progressBox",children:Object(A.jsx)(U.a,{type:"circle",percent:p})}),Object(A.jsxs)(b.a,{gutter:16,children:[Object(A.jsx)(f.a,{span:8,children:Object(A.jsx)(v.a,{title:"\u603b\u9875\u6570",children:u.allPage||0})}),Object(A.jsx)(f.a,{span:8,children:Object(A.jsx)(v.a,{title:"\u5df2\u4e0b\u8f7d",children:u.downPage||0})}),Object(A.jsx)(f.a,{span:8,children:Object(A.jsxs)(v.a,{title:"\u4e0b\u8f7d\u8fdb\u5ea6",children:[u.progress||0,"%"]})})]}),Object(A.jsx)("div",{className:"tipsBox",children:"tips\uff1a\u4e00\u6b21\u53ea\u80fd\u4e0b\u8f7d\u4e00\u4e2a\u4efb\u52a1\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u4e0b\u8f7d\u5b8c\u6210\uff01"})]})})},$=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={title:"Title",data:[],count:0,checkedArr:[],loading:!1,allDownLoading:!1,aDownThrottle:null,isAllChecked:!1,isNowDown:!1},e.childRef=c.a.createRef(),e.childProgressRef=c.a.createRef(),e.onChange=function(t,n,a){var c=e.state.data;c[a].checked=t.target.checked,e.setState({data:c,checkedArr:c.filter((function(e){return e.checked})).map((function(e){return{id:e.chapterId,title:e.title}}))})},e.onAllChange=function(t){var n=t.target.checked,a=e.state.data;a=a.map((function(e){return Object(O.a)(Object(O.a)({},e),{},{checked:n})})),e.setState({data:a,checkedArr:a.filter((function(e){return e.checked})).map((function(e){return{id:e.chapterId,title:e.title}})),isAllChecked:n})},e.aDown=function(t){D({id:t.chapterId,title:e.state.title,zj_tit:t.title}).then((function(t){200===t.code?(q.b.success("\u5df2\u5f00\u59cb\u4e0b\u8f7d\uff01\uff01\uff01"),e.setState({isNowDown:!0})):q.b.error(t.massage)}))},e.allDown=function(){var t=e.state,n=t.title,a=t.data,c=t.checkedArr;c.length?(e.setState({allDownLoading:!0}),N({title:n,arr:c}).then((function(){q.b.success("\u5df2\u5f00\u59cb\u6279\u91cf\u4e0b\u8f7d\uff01\uff01\uff01"),e.setState({data:a.map((function(e){return Object(O.a)(Object(O.a)({},e),{},{checked:!1})})),allDownLoading:!1,isNowDown:!0,checkedArr:[],isAllChecked:!1})}))):q.b.error("\u8bf7\u9009\u62e9\u8981\u4e0b\u8f7d\u7684\u6f2b\u753b\uff01")},e.detail=function(t){e.childRef.current.getValue(t)},e.getProgress=function(){e.childProgressRef.current.getValue()},e}return Object(d.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({aDownThrottle:K(this.aDown)})}},{key:"componentDidMount",value:function(){var e,t=this,n=this.props.match.params,a=n.id,c=n.title;this.setState({title:c,loading:!0}),(e=a,y("/api/pingccApi/list?cartoonId=".concat(e))).then((function(e){var n=e.data||{count:0,data:[]},a=n.count,c=n.data;t.setState({data:c.map((function(e){return Object(O.a)(Object(O.a)({},e),{},{checked:!1})})),count:a,loading:!1})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.checkedArr,a=t.allDownLoading,c=t.aDownThrottle,i=t.isAllChecked,r=t.isNowDown;return Object(A.jsxs)("div",{children:[Object(A.jsx)(M.a,{className:"site-page-header",onBack:function(){var t,n;return null===(t=e.props)||void 0===t||null===(n=t.history)||void 0===n?void 0:n.goBack()},title:this.state.title,extra:[Object(A.jsx)(Y.a,{onClick:this.getProgress,type:"primary",children:"\u67e5\u770b\u4e0b\u8f7d\u8fdb\u5ea6"},"1")]}),Object(A.jsx)(X,{isNowDown:r,aDown:c,childRef:this.childRef}),Object(A.jsx)(Z,{setDownStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.setState({isNowDown:t})},childRef:this.childProgressRef}),Object(A.jsx)(H.a,{children:Object(A.jsx)("div",{style:Q,children:"UP"})}),Object(A.jsxs)("div",{className:"affixClass",children:[Object(A.jsx)(W.a,{checked:i,disabled:r,onChange:this.onAllChange,children:"\u5168\u9009"}),Object(A.jsx)(z.a,{value:n.length,prefix:"\u5df2\u9009\u4e2d"}),Object(A.jsx)(B.a,{title:"\u786e\u5b9a\u6279\u91cf\u4e0b\u8f7d\u5417?",onConfirm:this.allDown,disabled:r,onCancel:function(){},okText:"Yes",cancelText:"No",children:Object(A.jsx)(Y.a,{type:"primary",icon:Object(A.jsx)(G.a,{}),disabled:r,loading:a,children:"\u6279\u91cf\u4e0b\u8f7d"})})]}),Object(A.jsx)("div",{className:"padding24",children:Object(A.jsx)(g.a,{spinning:this.state.loading,children:Object(A.jsx)(E.b,{className:"demo-loadmore-list",itemLayout:"horizontal",dataSource:this.state.data,grid:{gutter:16,xs:1,sm:2,md:2,lg:3,xl:3,xxl:3},renderItem:function(t,n){return Object(A.jsx)(E.b.Item,{children:Object(A.jsxs)(b.a,{gutter:16,justify:"space-around",align:"middle",children:[Object(A.jsx)(f.a,{className:"gutter-row",span:2,children:Object(A.jsx)(W.a,{onChange:function(a){return e.onChange(a,t,n)},indeterminate:!1,checked:t.checked,disabled:r})}),Object(A.jsx)(f.a,{className:"gutter-row",span:10,children:Object(A.jsx)(E.b.Item.Meta,{title:t.title})}),Object(A.jsx)(f.a,{className:"gutter-row",span:10,children:Object(A.jsxs)(h.b,{className:"flexEnd",children:[Object(A.jsx)(Y.a,{onClick:function(){return e.detail(t)},children:"\u67e5\u770b"}),Object(A.jsx)(Y.a,{onClick:function(){return c(t)},disabled:r,type:"primary",icon:Object(A.jsx)(G.a,{})})]})})]})})}})})})]})}}]),n}(a.Component),ee=(n(768),n(480)),te=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(A.jsx)(ee.a,{status:"500",title:"500",subTitle:"Sorry, something went wrong.",extra:Object(A.jsx)(Y.a,{type:"primary",onClick:function(){e.props.history.push("/")},children:"Back Home"})})}}]),n}(a.Component);function ne(){return Object(A.jsx)(s.a,{children:Object(A.jsx)("div",{children:Object(A.jsxs)(o.c,{children:[Object(A.jsx)(o.a,{path:"/list/:id/:title",component:$}),Object(A.jsx)(o.a,{path:"/error",component:te}),Object(A.jsx)(o.a,{path:"/",children:Object(A.jsx)(T,{})})]})})})}var ae=function(){return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(ne,{})})},ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1009)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};n(770),n(820);r.a.render(Object(A.jsx)(ae,{}),document.getElementById("root")),ce()},685:function(e,t,n){},697:function(e,t,n){},755:function(e,t,n){}},[[1001,1,2]]]);
//# sourceMappingURL=main.5e443c09.chunk.js.map